document.addEventListener("DOMContentLoaded",(event)=>{gsap.registerPlugin(ScrollTrigger);const cursorDot=document.getElementById('cursor-dot');const cursorFollower=document.getElementById('cursor-follower');const links=document.querySelectorAll('a');const content=document.getElementsByClassName('content')[0];const container=document.getElementsByClassName('body-container')[0];const tl=gsap.timeline({onComplete:()=>{document.body.style.overflow='auto';setupScrollAnimations()}});if(!sessionStorage.getItem('hasVisited')&&!(window.location.pathname.includes("works.html")||window.location.pathname.includes("about.html"))){sessionStorage.setItem('hasVisited','true');animatePreloader(tl)}else{gsap.set(container,{y:'100vh',x:'100vw',autoAlpha:1});gsap.to(container,{y:'0vh',x:'0vw',duration:1.2,ease:'power3.out',onComplete:()=>{document.body.style.overflow='auto';setupScrollAnimations()}})}
if(window.location.pathname.includes("index.html")){animatePreloader(tl);tl.to(content,{autoAlpha:1,duration:1,ease:"power2.out"})}else{tl.to(content,{autoAlpha:1,duration:1,ease:"power2.out"})}
const navLinks=document.querySelectorAll('.nav-link');const currentPage=document.getElementsByClassName('body-container')[0];navLinks.forEach(link=>{const destination=link.getAttribute('href');if(!destination.includes('.html')){return}
link.addEventListener('click',(e)=>{e.preventDefault();gsap.to(currentPage,{scale:0.8,y:'-100%',x:'-100%',rotationY:-15,rotationZ:-5,duration:1.0,ease:'power3.in',onComplete:()=>{window.location.href=destination}})})});let mouseX=0;let mouseY=0;let followerX=0;let followerY=0;const easing=0.08;document.addEventListener('mousemove',(e)=>{mouseX=e.clientX;mouseY=e.clientY});function animate(){cursorDot.style.transform=`translate(${mouseX - 4}px, ${mouseY - 4}px)`;const dx=mouseX-followerX;const dy=mouseY-followerY;followerX+=dx*easing;followerY+=dy*easing;cursorFollower.style.transform=`translate(${followerX - 15}px, ${followerY - 15}px)`;requestAnimationFrame(animate)}
animate();links.forEach(link=>{link.addEventListener('mouseenter',()=>{cursorFollower.classList.add('hover');cursorDot.classList.add('hidden')});link.addEventListener('mouseleave',()=>{cursorFollower.classList.remove('hover');cursorDot.classList.remove('hidden')})})})
function animatePreloader(tl){const preloader=document.getElementById('preloader');const loaderTitle=document.getElementById('loader-title');const line=document.querySelector('.line');const content=document.getElementsByClassName('content')[0];const logoContainer=document.querySelector('.logo-container');const logoLink=document.querySelector('.logo-container a');gsap.set(content,{autoAlpha:0});gsap.set(line,{scaleX:0});gsap.set(content,{autoAlpha:1});const targetRect=logoContainer.getBoundingClientRect();gsap.set(content,{autoAlpha:0});const headingRect=loaderTitle.getBoundingClientRect();const yMove=targetRect.top-headingRect.top;const xMove=targetRect.left-headingRect.left;tl.to(loaderTitle,{fontSize:'0px',textTransform:'uppercase',fontWeight:700,color:'#333',duration:1.2,ease:"power3.inOut",delay:1.5},"-=1.0");tl.to([preloader,line],{opacity:0,duration:0.8,ease:"power1.in",onComplete:()=>{logoLink.appendChild(loaderTitle);loaderTitle.outerHTML=`<span style="font-size: 16px; text-transform: uppercase; font-weight: 700;">${loaderTitle.textContent}</span>`;preloader.style.display='none'}},"-=0.5");tl.to(content,{autoAlpha:1,duration:1,ease:"power2.out"})}
function setupScrollAnimations(){const textElement=document.querySelector(".scroll-fade-in");if(!textElement||textElement.dataset.split)return;textElement.dataset.split="true";const text=textElement.textContent;const words=text.split(' ');textElement.innerHTML='';words.forEach(word=>{const span=document.createElement('span');span.textContent=word+' ';textElement.appendChild(span)});const wordSpans=textElement.querySelectorAll('span');wordSpans.forEach(word=>{gsap.to(word,{opacity:1,ease:"power1.inOut",scrollTrigger:{trigger:word,scroller:".content",start:"top 80%",end:"bottom 20%",toggleActions:"play reverse play reverse",scrub:!0}})})}